---
title: "emptyDrops"
output: html_document
author: "Kevin Rue"
date: "`r Sys.Date()`"
---

```{r libraries, include=FALSE}
library(S4Vectors)
library(tidyverse)
```

```{r snakemake, include=FALSE}
rds_file <- snakemake@input[["rds"]]
```

## EmptyDrops results

```{r read_tsv, echo=FALSE}
#| message: false
emptydrops_results <- readRDS(rds_file)
emptydrops_results
```

## Overall statistics

```{r filter_stats, echo=FALSE}
#| message: false
thresholds <- c(0.01, 0.001, 0.0001, 0.00001)
filter_stats <- tibble(
    threshold = thresholds,
    barcodes = vapply(thresholds, function(x) sum(emptydrops_results$FDR < x, na.rm = TRUE), integer(1))
)
filter_stats
```

## Session info

```{r session_info, echo=FALSE}
sessionInfo()
```
